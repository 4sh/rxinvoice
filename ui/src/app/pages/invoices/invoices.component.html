<!-- [HEADER] -->

<form class="invoiceFilter" #searchForm="ngForm" (change)="research()">
    <div class="row">
        <div class="columns shrink">
            <div class="row align-middle">
                <button class="columns shrink">
                    <h6>{{'invoices.filter.title' | translate}}</h6>
                </button>

                <div class="columns">
                    <button type="button"
                            (click)="toggleFilter('REFERENCE')"
                            [ngClass]="{'isActive green': filterString ===  'REFERENCE',
                   'spinner':  filterString ===  'REFERENCE' && isPending}"
                            class="round large listFilter-item">
                        {{'invoices.filter.ref' | translate}}
                    </button>
                </div>

                <!--FIXME add spinner when because the orderBy can take some time !-->

                <div class="columns">
                    <button type="button"
                            (click)="toggleFilter('DATE')"
                            [ngClass]="{'isActive green': filterString ===  'DATE',
                   'spinner':  filterString ===  'DATE' && isPending}"
                            class="round large listFilter-item">
                        {{'invoices.filter.date' | translate}}
                    </button>
                </div>
            </div>
        </div>

        <div class="columns shrink">
                <input class="input search small" type="text" placeholder="Recherche"
                       debounce [delay]="1000" (func)="research()" ngModel name="query">
        </div>

        <div class="columns auto text-right inner-space-top-5">
            <button class="button medium green ripple"
                    routerlink="/invoices/new">
                <i class="ion-plus-round"></i>{{'invoices.newInvoice' | translate}}
            </button>

            <button class="button medium primary ripple has-img"
                    type="button">
                <img class="icon" src="assets/images/png/icon_excel.png">
            </button>
        </div>
    </div>

    <!-- Select input -->

    <div class="invoiceSelect row">

        <!-- Invoice number -->

        <div class="invoiceNumber columns small-6 inner-space-top-15">
            <h6> <strong>{{ invoices && invoices.length ? invoices.length : 0 }}</strong> {{'invoices.total.number' | translate}}
                <strong>0000</strong> {{'invoices.total.euros' | translate}}</h6>
        </div>

        <div class="columns small-18 inner-space-top-4">
            <div class="row">
                <div class="columns small-3">
                    <div class="invoiceSelect-date">
                        <input type="date" ngModel name="startDate">
                    </div>
                </div>

                <div class="columns small-3">
                    <div class="invoiceSelect-date">
                        <input type="date" ngModel name="endDate">
                    </div>
                </div>

                <div class="columns small-6">
                    <div class="invoiceSelect-item">
                        <select ngModel name="buyer">
                            <option value="">{{'invoices.filter.client' | translate}}</option>
                            <option *ngFor="let company of companies" [ngValue]="company._id">
                                {{company.name}}
                            </option>
                        </select>
                    </div>
                </div>

                <div class="columns small-6">
                    <div class="invoiceSelect-item">
                        <select ngModel name="statuses">
                            <option value="">{{'invoice.status.all' | translate}}</option>
                            <option *ngFor="let status of statuses" [ngValue]="status">
                                {{'invoice.status.' + status | translate}}
                            </option>
                        </select>
                    </div>
                </div>

                <div class="columns small-6">
                    <div class="invoiceSelect-item">
                        <select ngModel name="kind">
                            <option value="">{{'invoice.kind.all' | translate}}</option>
                            <option *ngFor="let kind of kinds" [ngValue]="kind">
                                {{'invoice.kind.' + kind | translate}}
                            </option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

</form>

<!-- [END HEADER] -->

<invoices-list [invoices]="invoices | orderBy: filterString"></invoices-list>
