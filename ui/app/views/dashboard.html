<div class="dashboard" ng-controller="DashboardCtrl">
    <h1 class="title-page">
        <span class="title-logo"></span>
        <span class="smallSeparator"></span>
        <span class="title-page-content">Bienvenue sur 4PM Facturation</span>
    </h1>

    <ul class="sorts-projects f-right">
        <li class="sorts-item title-list-sorts" style="display: none">Trie :</li>
        <li class="sorts-item" style="display: none">Status</li>
        <li class="sorts-item" style="display: none">Type</li>
        <li class="sorts-item" style="display: none">Nom</li>
    </ul>

    <hr class="clear"/>



    <div class="columns-bloc col-type-left">
        <div class="zone-title">
            <h1 class="title-col">Client</h1>
            <span class="info-stat">(*) {{nbCompanies()}} client pour {{nbBusiness()}} affaire(s)
               <div class="sorts-a-z">A-Z<span class="arrow-bottom"></span></div>
            </span>

        </div>
        <div class="zone-actions">
            <button class="fsh-btn-add" ng-click="addCompany()"><span class="icon-buttonAdd"></span> Ajouter</button>
            <select ui-select2 ng-model="filter.companySelected" data-placeholder="-- Sélectionner un client --" style="width: 200px;">
                <option value=""></option>
                <option ng-repeat="item in filter.companiesList" value="{{item._id}}">{{item.name}}</option>
            </select>
            <select ui-select2 ng-show="filter.companySelected" ng-model="filter.businessSelected" data-placeholder="-- Sélectionner une affaire --" style="width: 200px;">
                <option value=""></option>
                <option ng-repeat="item in filter.businessList" value="{{item.reference}}">{{item.name}}</option>
            </select>
            <a ng-click="filter.clearCompany()"><span class="fsh-btn-refresh"></span></a>
            <hr class="clear"/>
        </div>

        <div class="bloc-type" ng-repeat="company in companies | filter:filter.filterCompanies" ng-class="{blocTypeOneCompany: $first && $last}">
            <div class="content-infos">
                <div class="avatar-project">
                    <img src="../images/no-icon-company.png" width="83" height="83" alt="{{company.name}}">
                    <btn class="show-all-project" ng-click="filter.selectCompany(company)">All Business</btn>
                </div>
                <div class="content-infos-project">
                    <div class="header-project">
                        <span class="title-project-content">
                            <a title="{{company.name}}" ng-click="filter.selectCompany(company)"> {{company.name}}</a>
                        </span>
                        <div class="invoices-number">
                            <h2>nombre de facture </h2>
                            <h1>{{company.metrics.nbInvoices}}</h1>
                        </div>
                    </div>
                    <div class="desc-project">
                        <div class="content-planned">
                            <div class="invoices-planned">
                                <h2>Prévu :</h2>
                                <h1>{{company.metrics.expected | currency}}</h1>
                            </div>
                            <div class="invoices-planned">
                                <h2>Facturé :</h2>
                                <h1>{{company.metrics.invoiced | currency}}</h1>
                            </div>
                        </div>
                        <div class="content-planned">
                            <div class="invoices-planned">
                                <h2>Echue :</h2>
                                <h1>{{company.metrics.expired | currency}}</h1>
                            </div>
                            <div class="invoices-planned">
                                <h2>Payé :</h2>
                                <h1>{{company.metrics.paid | currency}}</h1>
                            </div>
                        </div>
                        <ul class="btn-edit">
                            <li><a ng-href='/#/company/{{company._id}}'><span class="small-icon-buttonedit"></span>Editer</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div ng-show="$first && $last">
                <ul class="tags-business">
                    <li ng-repeat="business in company.business" ng-click="filter.selectBusiness(business)">{{business.name}}</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="columns-bloc col-type-right">
        <div class="zone-title">
             <h1 class="title-col">Factures</h1>
             <span class="info-stat">(*) {{nbInvoices()}} facture(s) pour un total de {{totalInvoices() | currency}}
                <div class="sorts-a-z">A-Z<span class="arrow-bottom"></span></div>
                <span class="separator-sorts">|</span>
                <div class="sorts-number">Total<span class="arrow-bottom"></span></div>
             </span>
        </div>
        <div class="zone-actions">
            <button class="fsh-btn-add" ng-click="addInvoice()"><span class="icon-buttonAdd"></span> Ajouter</button>
            <select ui-select2 ng-model="filter.statusSelected" data-placeholder="-- Sélectionner un status --">
                <option value=""></option>
                <option ng-repeat="item in filter.statusList" value="{{item._id}}">{{item.name}}</option>
            </select>
            <a ng-click="filter.clearStatus()"><span class="fsh-btn-refresh"></span></a>
            <hr class="clear"/>
        </div>

        <div class="bloc-type" ng-repeat="invoice in invoices | filter:filter.filterInvoices | orderBy:orderByFunction">
            <div class="content-infos content-bloc-invoice">
                <div class="avatar-project">
                    <img src="../images/no-icon-project.png" alt="{{invoice.name}}">
                </div>
                <div class="content-infos-project">
                    <div class="header-project">
                        <span class="title-project-content">
                            <a title="{{invoice.reference}}" ng-click="filter.selectBusinessFromInvoice(invoice)"> {{invoice.reference}}</a>
                            <ul class="invoice-date">
                                <li>Du : {{invoice.date | date:'dd/MM/yyyy'}}</li>
                                <li>Date d'échéance : {{findExpiredInvoice(invoice.date)}}</li>
                            </ul>
                        </span>
                        <div class="invoices-number">
                            <h2>Total </h2>
                            <h1>{{invoice.grossAmount | currency}} HT</h1>
                        </div>
                    </div>
                    <div class="desc-project">
                        <span class="invoices-status {{invoice.status}}"><p>{{translateStatusLabel(invoice.status)}}</p></span>
                        <ul class="btn-edit">
                            <li><a ng-href='/#/invoice/{{invoice._id}}'><span class="small-icon-buttonedit"></span>Voir la facture</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
